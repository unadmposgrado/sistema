# ğŸ“ˆ DIAGRAMAS TÃ‰CNICOS DETALLADOS

---

## 1. FLUJO COMPLETO DEL SISTEMA

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USUARIO NO AUTENTICADO                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ registro.html â†’ registro.js                                             â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                                                         â”‚
â”‚ Form Input: nombre, email, password, password_confirm                  â”‚
â”‚                                                                         â”‚
â”‚ Auth.signUp(email, password) â†’ auth.users (Supabase)                   â”‚
â”‚                                                                         â”‚
â”‚ INSERT perfiles (registro.js lÃ­nea 54-60):                             â”‚
â”‚   âŒ ACTUAL:                       âœ… NUEVO:                           â”‚
â”‚   â”œâ”€ id: userId                    â”œâ”€ id: userId                       â”‚
â”‚   â”œâ”€ nombre                        â”œâ”€ nombre                           â”‚
â”‚   â””â”€ email                         â”œâ”€ email                            â”‚
â”‚                                    â”œâ”€ rol: 'aspirante'   â† AGREGAR    â”‚
â”‚                                    â””â”€ onboarding: false  â† AGREGAR    â”‚
â”‚                                                                         â”‚
â”‚ Resultado: Email de confirmaciÃ³n enviado                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EMAIL CONFIRMACIÃ“N (Supabase auth)                                      â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                                                         â”‚
â”‚ Usuario confirma email en link                                         â”‚
â”‚ Supabase marca email_confirmed_at                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ login.html â†’ login.js                                                   â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                                                         â”‚
â”‚ Form Input: email, password                                            â”‚
â”‚                                                                         â”‚
â”‚ Auth.signInWithPassword(email, password)                               â”‚
â”‚ â”œâ”€ Valida contra auth.users                                            â”‚
â”‚ â”œâ”€ Retorna session.user                                                â”‚
â”‚ â””â”€ Cookie de sesiÃ³n creada                                             â”‚
â”‚                                                                         â”‚
â”‚ SELECT rol FROM perfiles WHERE id = userId (login.js lÃ­nea 106)        â”‚
â”‚                                                                         â”‚
â”‚ âŒ ACTUAL:                        âœ… NUEVO:                            â”‚
â”‚ â””â”€ rol: NULL (problema)           â”œâ”€ rol: 'aspirante' âœ…              â”‚
â”‚                                    â””â”€ if (!rol) {...}  â† VALIDAR      â”‚
â”‚                                                                         â”‚
â”‚ Redirect: dashboard.html                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ dashboard.html â†’ dashboard.js                                           â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                                                         â”‚
â”‚ getSession() â†’ Valida que existe sesiÃ³n activa                         â”‚
â”‚                                                                         â”‚
â”‚ SELECT id, rol, onboarding_completo FROM perfiles (lÃ­nea 46)          â”‚
â”‚   â”œâ”€ id: [UUID]                                                        â”‚
â”‚   â”œâ”€ rol: 'aspirante' (ahora explÃ­cito âœ…)                             â”‚
â”‚   â””â”€ onboarding_completo: false (ahora explÃ­cito âœ…)                   â”‚
â”‚                                                                         â”‚
â”‚ Â¿Admin?                                                                â”‚
â”‚   â”œâ”€ SÃ­ (rol == 'admin') â†’ Ir a paso DASHBOARD NORMAL                 â”‚
â”‚   â””â”€ No â†’ Continuar...                                                 â”‚
â”‚                                                                         â”‚
â”‚ Â¿Onboarding completado?                                                â”‚
â”‚   â”œâ”€ SÃ­ (onboarding_completo == true) â†’ DASHBOARD NORMAL              â”‚
â”‚   â””â”€ No (== false) â†’ MOSTRAR ONBOARDING                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ (SI)                                â”‚ (NO)                     
         â”‚                                     â”‚                         
         â–¼                                     â–¼                         
    DASHBOARD                          ONBOARDING                        
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              
    â”‚ Normalâ”‚                         â”‚ modules/          â”‚              
    â”‚       â”‚                         â”‚ onboarding/{rol}  â”‚              
    â””â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚ .js               â”‚              
                                      â”‚                   â”‚              
                                      â”‚ Renderiza form    â”‚              
                                      â”‚ especÃ­fico del rolâ”‚              
                                      â”‚                   â”‚              
                                      â”‚ ASPIRANTE:        â”‚              
                                      â”‚ â”œâ”€ interes_acad  â”‚              
                                      â”‚ â””â”€ institucion    â”‚              
                                      â”‚                   â”‚              
                                      â”‚ ESTUDIANTE:       â”‚              
                                      â”‚ â”œâ”€ matricula      â”‚              
                                      â”‚ â”œâ”€ grado          â”‚              
                                      â”‚ â””â”€ institucion    â”‚              
                                      â”‚                   â”‚              
                                      â”‚ FORMADOR:         â”‚              
                                      â”‚ â”œâ”€ area_expertise â”‚              
                                      â”‚ â”œâ”€ experiencia    â”‚              
                                      â”‚ â””â”€ institucion    â”‚              
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              
                                             â”‚                           
                                             â–¼                           
                                      UPDATE perfiles:                    
                                      â”œâ”€ [campos especÃ­ficos]            
                                      â””â”€ onboarding_completo = true      
                                             â”‚                           
                                             â–¼                           
                                      Redirect: dashboard.html           
                                      (reinicia flujo)                   
                                             â”‚                           
                                             â–¼                           
                                      Dashboard.js (2do login)           
                                      â””â”€ onboarding_completo = true      
                                         â†’ DASHBOARD NORMAL              
```

---

## 2. ESTRUCTURA DE TABLA `perfiles`

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        TABLA: perfiles                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  COLUMNAS IMPRESCINDIBLES (5) - Presentes en TODO usuario              â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•            â”‚
â”‚  â”Œâ”€ id (UUID, PK) â”€â”€â”€â”€â”€â”€â”€â”€ Identidad del usuario                      â”‚
â”‚  â”‚  â”œâ”€ FK: auth.users(id)                                             â”‚
â”‚  â”‚  â””â”€ Nunca NULL                                                     â”‚
â”‚  â”‚                                                                    â”‚
â”‚  â”œâ”€ nombre (VARCHAR) â”€â”€â”€â”€â”€ Nombre del usuario                        â”‚
â”‚  â”‚  â”œâ”€ Ingresado en: registro.html                                   â”‚
â”‚  â”‚  â”œâ”€ LeÃ­do en: mÃºltiples mÃ³dulos                                   â”‚
â”‚  â”‚  â””â”€ Nunca NULL                                                    â”‚
â”‚  â”‚                                                                    â”‚
â”‚  â”œâ”€ email (VARCHAR) â”€â”€â”€â”€â”€â”€ Email (identificador)                     â”‚
â”‚  â”‚  â”œâ”€ Ingresado en: registro.html                                   â”‚
â”‚  â”‚  â”œâ”€ Usado en: auth.users                                          â”‚
â”‚  â”‚  â””â”€ Nunca NULL                                                    â”‚
â”‚  â”‚                                                                    â”‚
â”‚  â”œâ”€ rol (VARCHAR) â”€â”€â”€â”€â”€â”€â”€â”€ Determina permisos y flujo                â”‚
â”‚  â”‚  â”œâ”€ Valores: 'aspirante'|'estudiante'|'formador'|'admin'         â”‚
â”‚  â”‚  â”œâ”€ DEFAULT: 'aspirante'  â† DEBE ESTAR EN REGISTRO             â”‚
â”‚  â”‚  â”œâ”€ Consultado en: login.js, dashboard.js, nav.js                â”‚
â”‚  â”‚  â”œâ”€ Escrito en: onboarding (cambio de rol) o admin               â”‚
â”‚  â”‚  â”œâ”€ âŒ PROBLEMA: Actualmente NULL en registro                    â”‚
â”‚  â”‚  â””â”€ âœ… SOLUCIÃ“N: Insertar 'aspirante' en registro.js             â”‚
â”‚  â”‚                                                                    â”‚
â”‚  â””â”€ onboarding_completo (BOOLEAN) â”€â”€ Controla flujo                 â”‚
â”‚     â”œâ”€ Valores: true|false                                          â”‚
â”‚     â”œâ”€ DEFAULT: false   â† DEBE ESTAR EN REGISTRO                   â”‚
â”‚     â”œâ”€ Consultado en: dashboard.js (lÃ­nea 58)                       â”‚
â”‚     â”œâ”€ Escrito en: onboarding-*.js (al completar formulario)       â”‚
â”‚     â”œâ”€ âŒ PROBLEMA: Actualmente NULL en registro                    â”‚
â”‚     â””â”€ âœ… SOLUCIÃ“N: Insertar false en registro.js                   â”‚
â”‚                                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚
â”‚  COLUMNAS ESPECÃFICAS POR ROL (9-10) - NULL para otros roles          â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•              â”‚
â”‚  â”Œâ”€ PARA ASPIRANTE:                                                   â”‚
â”‚  â”‚  â”œâ”€ interes_academico (VARCHAR)    â† Inscrito en onboarding      â”‚
â”‚  â”‚  â”œâ”€ grado (VARCHAR)                â† Inscrito en onboarding      â”‚
â”‚  â”‚  â””â”€ institucion (VARCHAR)          â† Inscrito en onboarding      â”‚
â”‚  â”‚     LeÃ­do en: Aspirante.seguimiento.js                            â”‚
â”‚  â”‚                                                                    â”‚
â”‚  â”œâ”€ PARA ESTUDIANTE:                                                  â”‚
â”‚  â”‚  â”œâ”€ matricula (VARCHAR)            â† Inscrito en onboarding      â”‚
â”‚  â”‚  â”œâ”€ grado (VARCHAR)                â† Inscrito en onboarding      â”‚
â”‚  â”‚  â”œâ”€ institucion (VARCHAR)          â† Inscrito en onboarding      â”‚
â”‚  â”‚  â”œâ”€ programaEducativo (VARCHAR)    â† NUNCA se escribe aquÃ­       â”‚
â”‚  â”‚  â””â”€ tutorAsignado (VARCHAR)        â† NUNCA se escribe aquÃ­       â”‚
â”‚  â”‚     LeÃ­do en: Estudiante.progreso.js                              â”‚
â”‚  â”‚                                                                    â”‚
â”‚  â”œâ”€ PARA FORMADOR:                                                    â”‚
â”‚  â”‚  â”œâ”€ area_expertise (VARCHAR)       â† Inscrito en onboarding      â”‚
â”‚  â”‚  â”œâ”€ experiencia (INTEGER)          â† Inscrito en onboarding      â”‚
â”‚  â”‚  â””â”€ institucion (VARCHAR)          â† Inscrito en onboarding      â”‚
â”‚  â”‚     LeÃ­do en: (no identificado en cÃ³digo actual)                  â”‚
â”‚  â”‚                                                                    â”‚
â”‚  â””â”€ PARA ADMIN:                                                        â”‚
â”‚     (ningÃºn campo especÃ­fico - no tiene onboarding)                  â”‚
â”‚                                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚
â”‚  COLUMNAS HUÃ‰RFANAS (3) âŒ - NUNCA SE USAN - ELIMINAR                 â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•              â”‚
â”‚  â”œâ”€ onboarding_paso (VARCHAR/INTEGER)    â† 0 referencias             â”‚
â”‚  â”œâ”€ onboarding_fecha (TIMESTAMP)         â† 0 referencias             â”‚
â”‚  â””â”€ onboarding_iniciado (BOOLEAN)        â† 0 referencias             â”‚
â”‚     AcciÃ³n: ALTER TABLE DROP COLUMN (despuÃ©s de CAMBIO 1+2)          â”‚
â”‚                                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚
â”‚  COLUMNAS ESTÃNDAR DE SUPABASE (2)                                     â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•              â”‚
â”‚  â”œâ”€ created_at (TIMESTAMP)   â† AutomÃ¡tico de Supabase                â”‚
â”‚  â””â”€ updated_at (TIMESTAMP)   â† AutomÃ¡tico de Supabase (opcional)     â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RESUMEN DE TAMAÃ‘O:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ACTUAL:
â”œâ”€ 5 imprescindibles
â”œâ”€ 9-10 especÃ­ficos (muchos NULL)
â”œâ”€ 3 huÃ©rfanos
â””â”€ Total: ~17-18 columnas

DESPUÃ‰S DE FASE 1:
â”œâ”€ 5 imprescindibles
â”œâ”€ 9-10 especÃ­ficos (muchos NULL aÃºn, pero necesarios)
â””â”€ Total: ~14-15 columnas (sin huÃ©rfanos)

DESPUÃ‰S DE FASE 2 (FUTURO):
â”œâ”€ perfiles: 7 columnas (MÃNIMO)
â”œâ”€ perfiles_aspirante: 4 columnas
â”œâ”€ perfiles_estudiante: 5 columnas
â””â”€ perfiles_formador: 4 columnas
```

---

## 3. MATRIZ DE LECTURA/ESCRITURA DE COLUMNAS

```
COLUMNA          â”‚ REGISTRO â”‚ ONBOARDING â”‚ DASHBOARD â”‚ ADMIN â”‚ OTROS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€
id               â”‚    W     â”‚     R      â”‚     R     â”‚   R   â”‚   R
nombre           â”‚    W     â”‚     R      â”‚     R     â”‚       â”‚   R
email            â”‚    W     â”‚            â”‚           â”‚       â”‚
rol              â”‚   âŒâŒ   â”‚            â”‚     R     â”‚       â”‚   R
onboarding_compl â”‚   âŒâŒ   â”‚     W      â”‚     R     â”‚       â”‚
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€
interes_acad     â”‚          â”‚  W (Asp)   â”‚           â”‚       â”‚
grado            â”‚          â”‚  W (Est)   â”‚           â”‚       â”‚
institucion      â”‚          â”‚  W (todos) â”‚           â”‚       â”‚
matricula        â”‚          â”‚  W (Est)   â”‚           â”‚       â”‚
programa         â”‚          â”‚            â”‚           â”‚       â”‚  R
tutor            â”‚          â”‚            â”‚           â”‚       â”‚  R
area_expertise   â”‚          â”‚  W (Form)  â”‚           â”‚       â”‚
experiencia      â”‚          â”‚  W (Form)  â”‚           â”‚       â”‚
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€
onboarding_paso  â”‚          â”‚            â”‚           â”‚       â”‚
onboarding_fecha â”‚          â”‚            â”‚           â”‚       â”‚
onboarding_ini   â”‚          â”‚            â”‚           â”‚       â”‚

LEYENDA: W=Write, R=Read, âŒâŒ=DEBE ESCRIBIR PERO NO LO HACE
```

---

## 4. COMPARATIVA ESTADO ACTUAL vs. IDEAL

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      REGISTRO NUEVO (LÃ­nea 54-60)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  âŒ ESTADO ACTUAL:                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ .insert([{                                          â”‚               â”‚
â”‚  â”‚   id: userId,                                       â”‚               â”‚
â”‚  â”‚   nombre,                                           â”‚               â”‚
â”‚  â”‚   email                                             â”‚               â”‚
â”‚  â”‚   // âŒ FALTA: rol                                  â”‚               â”‚
â”‚  â”‚   // âŒ FALTA: onboarding_completo                 â”‚               â”‚
â”‚  â”‚ }])                                                 â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                         â”‚
â”‚  RESULTADO EN BD:                                                      â”‚
â”‚  id = '123e...' âœ…                                                     â”‚
â”‚  nombre = 'Juan' âœ…                                                    â”‚
â”‚  email = 'juan@...' âœ…                                                 â”‚
â”‚  rol = NULL âŒ PROBLEMA                                                â”‚
â”‚  onboarding_completo = NULL âŒ PROBLEMA                                â”‚
â”‚                                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚
â”‚                                                                         â”‚
â”‚  âœ… ESTADO IDEAL (DESPUÃ‰S DE CAMBIO 1):                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ .insert([{                                          â”‚               â”‚
â”‚  â”‚   id: userId,                                       â”‚               â”‚
â”‚  â”‚   nombre,                                           â”‚               â”‚
â”‚  â”‚   email,                                            â”‚               â”‚
â”‚  â”‚   rol: 'aspirante',         â† AGREGAR              â”‚               â”‚
â”‚  â”‚   onboarding_completo: false â† AGREGAR             â”‚               â”‚
â”‚  â”‚ }])                                                 â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                         â”‚
â”‚  RESULTADO EN BD:                                                      â”‚
â”‚  id = '123e...' âœ…                                                     â”‚
â”‚  nombre = 'Juan' âœ…                                                    â”‚
â”‚  email = 'juan@...' âœ…                                                 â”‚
â”‚  rol = 'aspirante' âœ… EXPLÃCITO                                        â”‚
â”‚  onboarding_completo = false âœ… EXPLÃCITO                              â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. LÃ“GICA DE FLUJO EN DASHBOARD.JS

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  dashboard.js lÃ­nea 45-58   â”‚
                    â”‚                             â”‚
                    â”‚ SELECT id, rol,             â”‚
                    â”‚        onboarding_completo  â”‚
                    â”‚ FROM perfiles WHERE id = ?  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                           â”‚
          âŒ ACTUAL              âœ… DESPUÃ‰S DE CAMBIO 1
          (FRÃGIL)               (ROBUSTO)
                    â”‚                           â”‚
    const userRole = perfil?.rol      const userRole = perfil?.rol
         || 'aspirante'  â† ImplÃ­cito         // = 'aspirante' ExplÃ­cito
                    â”‚                           â”‚
    const onboarding =                const onboarding =
    perfil?.onboarding_completo        perfil?.onboarding_completo
         || false       â† ImplÃ­cito         // = false ExplÃ­cito
                    â”‚                           â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ if (userRole === 'admin'    â”‚
                    â”‚     && onboarding)          â”‚
                    â”‚                             â”‚
                    â”‚ Â¿Admin? Â¿Sin onboarding?    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
                    â”‚            â”‚
                   SÃ            NO
                    â”‚            â”‚
                    â–¼            â–¼
              DASHBOARD    MOSTRAR ONBOARDING
              NORMAL       (modules/onboarding/)
                â”‚                   â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Renderizar interface  â”‚
              â”‚ segÃºn rol             â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. IMPACTO DE LOS 3 CAMBIOS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     CAMBIO 1: registro.js                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚ LÃ­neas afectadas: 54-60 (INSERT statement)                          â”‚
â”‚ LÃ­neas nuevas: 2 (rol, onboarding_completo)                         â”‚
â”‚ Riesgo: ğŸŸ¢ BAJO                                                     â”‚
â”‚                                                                      â”‚
â”‚ Impacto:                                                            â”‚
â”‚  âœ… Nuevos usuarios: rol siempre = 'aspirante'                      â”‚
â”‚  âœ… Nuevos usuarios: onboarding_completo siempre = false            â”‚
â”‚  âœ… Usuarios existentes: NO AFECTADOS                               â”‚
â”‚  âœ… Flujo login: Funciona igual o mejor                             â”‚
â”‚  âœ… Flujo dashboard: Funciona igual                                 â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     CAMBIO 2: login.js                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚ LÃ­neas afectadas: 105-127 (redirectByRole function)                 â”‚
â”‚ LÃ­neas nuevas: ~12 (validaciÃ³n defensiva)                           â”‚
â”‚ Riesgo: ğŸŸ¢ MUY BAJO                                                 â”‚
â”‚                                                                      â”‚
â”‚ Impacto:                                                            â”‚
â”‚  âœ… Usuarios nuevos: Sin cambio (rol nunca NULL)                    â”‚
â”‚  âœ… Usuarios antiguos: Si rol es NULL, se asigna 'aspirante'        â”‚
â”‚  âœ… Se actualiza en BD para evitar repeticiÃ³n                       â”‚
â”‚  âœ… Defensivo contra errores futuros                                â”‚
â”‚  âœ… No rompe nada, solo agrega protecciÃ³n                           â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  CAMBIO 3: Supabase SQL                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚ AcciÃ³n: ALTER TABLE DROP COLUMN                                     â”‚
â”‚ Columnas: onboarding_paso, onboarding_fecha, onboarding_iniciado    â”‚
â”‚ Riesgo: ğŸŸ¢ BAJO                                                     â”‚
â”‚                                                                      â”‚
â”‚ Impacto:                                                            â”‚
â”‚  âœ… CÃ³digo: NO AFECTADO (nunca las usÃ³)                            â”‚
â”‚  âœ… BD: MÃ¡s limpia y clara                                         â”‚
â”‚  âœ… Espacio: Se libera (pequeÃ±o)                                   â”‚
â”‚  âœ… Mantenibilidad: Mejor (sin columnas huÃ©rfanas)                 â”‚
â”‚  âœ… Reversibilidad: DifÃ­cil pero posible con backup               â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

IMPACTO TOTAL:
â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… CÃ³digo mÃ¡s limpio y robusto
âœ… Base de datos mÃ¡s consistente
âœ… Menor riesgo de errores futuros
âœ… Mejor mantenibilidad
âœ… Sin impacto negativo en funcionalidad
```

---

**Fin de diagramas tÃ©cnicos detallados** âœ…
